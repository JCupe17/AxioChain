<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Bet2</title>

    <link rel="stylesheet" type="text/css" href="./css/main.css">

    <script src="../src/node_modules/web3/dist/web3.min.js"></script>

</head>
<body>
    <div class="container">

        <h1>Bet on the Match: Liverpool-Man City</h1>

        
        <img id="loader" src="https://loading.io/spinners/double-ring/lg.double-ring-spinner.gif">
        <label for="team" class="col-lg-2 control-label">Winner</label>
        <input id="team" type="text">
        
        <label for="winner" class="col-lg-2 control-label">Value</label>
        <input id="value" type="text">

        <button id="button">Bet</button>
        <h2 id="winner"></h2>
        

    </div>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    
    <script>

        if (typeof web3 !== 'undefined') {
            web3 = new Web3(web3.currentProvider);
        } else {
            // set the provider you want from Web3.providers
            web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:3000"));
        }

        web3.eth.defaultAccount = web3.eth.accounts[0];

        var axiochainContract = web3.eth.contract([{"constant":true,"inputs":[],"name":"name","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_spender","type":"address"},{"name":"_value","type":"uint256"}],"name":"approve","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"pseudos","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"games","outputs":[{"name":"gameID","type":"uint8"},{"name":"homeTeamGoals","type":"uint8"},{"name":"awayTeamGoals","type":"uint8"},{"name":"result","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_gameID","type":"uint8"}],"name":"updateCote","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"totalSupply","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"gameIDs","outputs":[{"name":"","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"bets","outputs":[{"name":"betID","type":"uint32"},{"name":"stake","type":"uint32"},{"name":"win","type":"uint8"},{"name":"sender","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_from","type":"address"},{"name":"_to","type":"address"},{"name":"_value","type":"uint256"}],"name":"transferFrom","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"decimals","outputs":[{"name":"","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"version","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"result","type":"uint8"},{"name":"_betIds","type":"uint32[]"}],"name":"getSum","outputs":[{"name":"sum","type":"uint32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"balance","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"symbol","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_gameID","type":"uint256"},{"name":"win","type":"uint8"},{"name":"_value","type":"uint32"}],"name":"placeOrder","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_to","type":"address"},{"name":"_value","type":"uint256"}],"name":"transfer","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_spender","type":"address"},{"name":"_value","type":"uint256"},{"name":"_extraData","type":"bytes"}],"name":"approveAndCall","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_gameID","type":"uint8"}],"name":"createMatch","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"},{"name":"_spender","type":"address"}],"name":"allowance","outputs":[{"name":"remaining","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_gameID","type":"uint256"},{"name":"homeGoals","type":"uint8"},{"name":"awayGoals","type":"uint8"}],"name":"updateStatus","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_gameID","type":"uint256"}],"name":"retribute","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_gameID","type":"uint8"}],"name":"getCote","outputs":[{"name":"","type":"uint16[3]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"pseudo","type":"string"}],"name":"register","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"payable":true,"stateMutability":"payable","type":"fallback"},{"anonymous":false,"inputs":[{"indexed":false,"name":"coted","type":"uint16"},{"indexed":false,"name":"coteh","type":"uint16"},{"indexed":false,"name":"cotea","type":"uint16"}],"name":"Cote","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"a","type":"uint32"},{"indexed":false,"name":"_reward","type":"uint32"},{"indexed":false,"name":"cote","type":"uint16"}],"name":"DebugEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"betID","type":"uint32"},{"indexed":false,"name":"stake","type":"uint32"},{"indexed":false,"name":"win","type":"uint8"},{"indexed":false,"name":"sender","type":"address"}],"name":"NewBetEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"_from","type":"address"},{"indexed":true,"name":"_to","type":"address"},{"indexed":false,"name":"_value","type":"uint256"}],"name":"Transfer","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"_owner","type":"address"},{"indexed":true,"name":"_spender","type":"address"},{"indexed":false,"name":"_value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"pseudo","type":"string"},{"indexed":false,"name":"tipe","type":"uint256"},{"indexed":false,"name":"value","type":"uint256"},{"indexed":false,"name":"win","type":"uint8"},{"indexed":false,"name":"gameID","type":"uint256"},{"indexed":false,"name":"blocknumber","type":"uint256"}],"name":"NewBlokkEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"previousOwner","type":"address"},{"indexed":true,"name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"}]);
        var Match = axiochainContract.at('0xf1a8f8721f8b403e29e971f7ebfcfb37b0ba9ed0');
        console.log(Match);

        var betEvent = Match.NewBetEvent({},'latest');

        betEvent.watch(function(error, result){
            if (!error)
                {
                    vh="the victory of Liverpool";
                    va="the victory of Man City";
                    vd="a draw";
                    l="";
                    if(result.args.win==0){l=vd;}
                    else{ if(result.args.win==1){l=vh;}
                        else{l=va;}
                        }
                    $("#loader").hide();
                    $("#winner").html('You just bet '+ result.args.stake + ' Axiocoin on '+l);
                } else {
                    $("#loader").hide();
                    console.log(error);
                }
        });

        $("#button").click(function() {
            $("#loader").show();
            l=0;
            if($("#team").val()=="Liverpool"){
                l=1;
            }
            else{if($("#team").val()=="Man City"){
                l=2;
            }

            }
            
            Match.placeOrder(2,l, $("#value").val(), function(error, result){
                if(!error){
                    console.log(result);}
                else{
                    console.error(error);}
            });
        });


    </script>

</body>
</html>