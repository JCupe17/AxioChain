<?php include '_head.php'; ?>

<div class="whole-area bg wrapper">

    <div class="search-area">
        <div class="container">
            <div class="date">Thursday March, 29th</div>

            <div class="time"></div>

            <form class="form search">
                <input type="search" name="s" class="control" placeholder="Search a team or a day"/>
                <button type="submit"><img src="img/glass.png" alt=""/></button>
            </form>
        </div>
    </div>

    <div class="heading-area">
        <div class="container">
            <div class="content">
                <h1 class="main-title">
                    <br>Ledger<br>
                    <img src="img/link2.png" alt=""/>
                    <img src="img/link2.png" alt=""/>
                    <img src="img/logo-coin.png" alt=""/>
                    <img src="img/link2.png" alt=""/>
                    <img src="img/link2.png" alt=""/>
                </h1>
            </div>

            <div class="action">
                <a href="#" class="btn secondary full disabled">
                    <img src="img/link.png" alt=""/>
                    Ledger
                </a>
            </div>

            <div class="action">
                <a href="#" class="btn secondary full">
                    <img src="img/refresh.png" alt=""/>
                    Update
                </a>
            </div>
        </div>
    </div>

    <div class="container">
        <a href="./list.php" class="back">
            <img src="img/arrow-left.png" alt=""/>
            Back to the Bet List
        </a>
    </div>

    <div class="matches-area">
        <div class="container">
            <div class="items">

                <div class="item">
                    <div class="meta">
                        <div class="inner">
                            <span class="date">29/03/2018</span>
                            <span class="dash">-</span>
                            <span id="time2" class="time">10h00</span>
                        </div>
                    </div>

                    <div class="name">
                        <div id="blocknumber" class="inner">
                        Block N°2015890
                        </div>
                    </div>

                    <div class="info">
                        <div class="inner">
                            <div id="part1" class="text">
                            Othmane bet 100 Axiocoin on Seville-Bayern match on Bayern
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="item">
                    <div class="meta">
                        <div class="inner">
                            <span class="date">27/03/2018</span>
                            <span class="dash">-</span>
                            <span class="time">17h54</span>
                        </div>
                    </div>

                    <div class="name">
                        <div class="inner">
                        Block N°2006399
                        </div>
                    </div>

                    <div class="info">
                        <div class="inner">
                            <div class="text">
                            Joanne bet 40 Axiocoin on Barcelona-Roma match on Barcelona
                            </div>
                        </div>
                    </div>
                </div>
                <div class="item">
                    <div class="meta">
                        <div class="inner">
                            <span class="date">27/03/2018</span>
                            <span class="dash">-</span>
                            <span class="time">17h19</span>
                        </div>
                    </div>

                    <div class="name">
                        <div class="inner">
                        Block N°2006260
                        </div>
                    </div>

                    <div class="info">
                        <div class="inner">
                            <div class="text">
                            Joanne bet 40 Axiocoin on Seville-Bayern match on Bayern
                            </div>
                        </div>
                    </div>
                </div>
                <div class="item">
                    <div class="meta">
                        <div class="inner">
                            <span class="date">27/03/2018</span>
                            <span class="dash">-</span>
                            <span class="time">16h10</span>
                        </div>
                    </div>

                    <div class="name">
                        <div class="inner">
                        Block N°2005986
                        </div>
                    </div>

                    <div class="info">
                        <div class="inner">
                            <div class="text">
                            Othmane bet 25 Axiocoin on Bayern-Dortmund match on Dortmund
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="item">
                    <div class="meta">
                        <div class="inner">
                            <span class="date">27/03/2018</span>
                            <span class="dash">-</span>
                            <span class="time">16h05</span>
                        </div>
                    </div>

                    <div class="name">
                        <div class="inner">
                        Block N°2005959
                        </div>
                    </div>

                    <div class="info">
                        <div class="inner">
                            <div class="text">
                            Othmane bet 50 Axiocoin on Schalke-Fribourg match on Schalke
                            </div>
                        </div>
                    </div>
                </div>
                <div class="item">
                    <div class="meta">
                        <div class="inner">
                            <span class="date">27/03/2018</span>
                            <span class="dash">-</span>
                            <span class="time">15h59</span>
                        </div>
                    </div>

                    <div class="name">
                        <div class="inner">
                        Block N°2005939
                        </div>
                    </div>

                    <div class="info">
                        <div class="inner">
                            <div class="text">
                            Othmane bet 60 Axiocoin on Barcelona-Roma match on Barcelona
                            </div>
                        </div>
                    </div>
                </div>
                <div class="item">
                    <div class="meta">
                        <div class="inner">
                            <span class="date">27/03/2018</span>
                            <span class="dash">-</span>
                            <span class="time">15h54</span>
                        </div>
                    </div>

                    <div class="name">
                        <div class="inner">
                        Block N°2005921
                        </div>
                    </div>

                    <div class="info">
                        <div class="inner">
                            <div class="text">
                            Othmane bet 45 Axiocoin on Liverpool-Man City match on Liverpool
                            </div>
                        </div>
                    </div>
                </div>

                <div class="item">
                    <div class="meta">
                        <div class="inner">
                            <span class="date">16/03/2018</span>
                            <span class="dash">-</span>
                            <span class="time">15h46</span>
                        </div>
                    </div>

                    <div class="name">
                        <div class="inner">
                        Block N°2005890
                        </div>
                    </div>

                    <div class="info">
                        <div class="inner">
                            <div class="text">
                            Othmane bet 100 Axiocoin on Seville-Bayern match on Bayern
                            </div>
                        </div>
                    </div>
                </div>

                <div class="item">
                    <div class="meta">
                        <div class="inner">
                            <span class="date">27/03/2018</span>
                            <span class="dash">-</span>
                            <span class="time">15h41</span>
                        </div>
                    </div>

                    <div class="name">
                        <div class="inner">
                        Block N°2005870
                        </div>
                    </div>

                    <div class="info">
                        <div class="inner">
                            <div class="text">
                            Othmane bet 30 Axiocoin on Juventus-Real match on Real
                            </div>
                        </div>
                    </div>
                </div>

                <div class="item">
                    <div class="meta">
                        <div class="inner">
                            <span class="date">27/03/2018</span>
                            <span class="dash">-</span>
                            <span class="time">15h36</span>
                        </div>
                    </div>

                    <div class="name">
                        <div class="inner">
                            Block N°2005842 
                        </div>
                    </div>

                    <div class="info">
                        <div class="inner">
                            <div class="text">
                            vincent bet 50 Axiocoin on Liverpool-Man City match on a draw
                            </div>
                        </div>
                    </div>
                </div>

                <div class="item">
                    <div class="meta">
                        <div class="inner">
                            <span class="date">27/03/2018</span>
                            <span class="dash">-</span>
                            <span class="time">15h24</span>
                        </div>
                    </div>

                    <div class="name">
                        <div class="inner">
                            Block N°2005785 
                        </div>
                    </div>

                    <div class="info">
                        <div class="inner">
                            <div class="text">
                                vincent bet 50 Axiocoin on Juventus-Real match on a draw
                            </div>
                        </div>
                    </div>
                </div>

                <div class="item">
                    <div class="meta">
                        <div class="inner">
                            <span class="date">27/03/2018</span>
                            <span class="dash">-</span>
                            <span class="time">15h09</span>
                        </div>
                    </div>

                    <div class="name">
                        <div class="inner">
                            Block N°2005741
                        </div>
                    </div>

                    <div class="info">
                        <div class="inner">
                            <div class="text">
                            vincent bet 100 Axiocoin on Bayern-Dortmund match on Bayern
                            </div>
                        </div>
                    </div>
                </div>

                <div class="item">
                    <div class="meta">
                        <div class="inner">
                            <span class="date">27/03/2018</span>
                            <span class="dash">-</span>
                            <span class="time">12h29</span>
                        </div>
                    </div>

                    <div class="name">
                        <div class="inner">
                            Block N°2005107
                        </div>
                    </div>

                    <div class="info">
                        <div class="inner">
                            <div class="text">
                            vincent bet 30 Axiocoin on Barcelona-Roma match on Roma
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="axiochain.js"></script>
<script>

    if (typeof web3 !== 'undefined') {
        web3 = new Web3(web3.currentProvider);
    } else {
        // set the provider you want from Web3.providers
        web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:3000"));
    }

    web3.eth.defaultAccount = web3.eth.accounts[0];

    var Match = axiochainABI.at(axiochainAddress);
    console.log(Match);

    var blokkEvent = Match.NewBlokkEvent({},'latest');

    blokkEvent.watch(function(error, result){
        if (!error)
        {   
            var a1=["Juventus","Seville","Liverpool","Barcelona","Schalke","Bayern"];
            var b1= ["Real","Bayern", "Man City", "Roma", "Fribourg","Dortmund"];
    
            console.log("l'event est arrivé");
            vh=("on "+a1[result.args.gameID-1]);
            va=("on " +b1[result.args.gameID-1]);
            vd="on a draw";
            l="";
            if(result.args.win==0){l=vd;}
            else{ if(result.args.win==1){l=vh;}
                else{l=va;}
            }
            s=(a1[result.args.gameID-1]+"-"+b1[result.args.gameID-1]+" match ");
            r=" bet ";
            if(result.args.tipe==1){r=" won "}
            var d= new Date();
            $("#time2").html(d.getHours()+'h'+d.getMinutes());
            $("#blocknumber").html('Block N°'+result.args.blocknumber);
            $("#part1").html(result.args.pseudo +r+result.args.value+' Axiocoin on '+s +l);
        } else {
            console.log(error);
        }
    });

</script>

<?php include '_foot.php'; ?>
